<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>工厂方法💫 | 代码片段</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <script data-ad-client="ca-pub-2245427233262012" async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="沉淀、分享、成长，让自己和他人都能有所收获！">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.9f4589a6.css" as="style"><link rel="preload" href="/assets/js/app.3776ebbf.js" as="script"><link rel="preload" href="/assets/js/5.eba49061.js" as="script"><link rel="preload" href="/assets/js/21.b3ec0304.js" as="script"><link rel="preload" href="/assets/js/6.a088a84b.js" as="script"><link rel="prefetch" href="/assets/js/10.ff684f25.js"><link rel="prefetch" href="/assets/js/11.af3486b3.js"><link rel="prefetch" href="/assets/js/12.3fb1b63b.js"><link rel="prefetch" href="/assets/js/13.fc5fb59d.js"><link rel="prefetch" href="/assets/js/14.a0422ee3.js"><link rel="prefetch" href="/assets/js/15.ca08b2ac.js"><link rel="prefetch" href="/assets/js/16.0491b187.js"><link rel="prefetch" href="/assets/js/17.cd495767.js"><link rel="prefetch" href="/assets/js/18.9fc76031.js"><link rel="prefetch" href="/assets/js/19.b5f75742.js"><link rel="prefetch" href="/assets/js/20.bb2a301f.js"><link rel="prefetch" href="/assets/js/22.38b3510f.js"><link rel="prefetch" href="/assets/js/7.26cef934.js"><link rel="prefetch" href="/assets/js/8.e2bad295.js"><link rel="prefetch" href="/assets/js/9.fb0c050c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.cc126f98.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.ee0aafb7.js"><link rel="prefetch" href="/assets/js/vendors~notification.7fc761b4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9f4589a6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">代码片段</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/patterns/index.html" class="nav-link">
  设计模式
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Spring
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/spring/index.html" class="nav-link">
  spring
</a></li><li class="dropdown-subitem"><a href="/java/spring/boot/index.html" class="nav-link">
  spring-boot
</a></li></ul></li><li class="dropdown-item"><h4>
          Netty
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/netty/index.html" class="nav-link">
  netty
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/go/index.html" class="nav-link">
  Go
</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/patterns/index.html" class="nav-link">
  设计模式
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Spring
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/spring/index.html" class="nav-link">
  spring
</a></li><li class="dropdown-subitem"><a href="/java/spring/boot/index.html" class="nav-link">
  spring-boot
</a></li></ul></li><li class="dropdown-item"><h4>
          Netty
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/netty/index.html" class="nav-link">
  netty
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/go/index.html" class="nav-link">
  Go
</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>创建型模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/patterns/factory_method.html" aria-current="page" class="active sidebar-link">工厂方法💫</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/patterns/factory_method.html#_1-为什么要使用" class="sidebar-link">1. 为什么要使用😇</a></li><li class="sidebar-sub-header"><a href="/patterns/factory_method.html#_2-使用场景" class="sidebar-link">2. 使用场景</a></li><li class="sidebar-sub-header"><a href="/patterns/factory_method.html#_3-实现方式" class="sidebar-link">3. 实现方式</a></li><li class="sidebar-sub-header"><a href="/patterns/factory_method.html#_4-优点缺点" class="sidebar-link">4. 优点缺点</a></li><li class="sidebar-sub-header"><a href="/patterns/factory_method.html#_5-工厂方法" class="sidebar-link">5. 工厂方法</a></li><li class="sidebar-sub-header"><a href="/patterns/factory_method.html#_6-其它设计模式关系" class="sidebar-link">6 其它设计模式关系</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="工厂方法"><a href="#工厂方法" class="header-anchor">#</a> 工厂方法💫</h1> <h2 id="_1-为什么要使用"><a href="#_1-为什么要使用" class="header-anchor">#</a> 1. 为什么要使用😇</h2> <p><strong>工厂方法模式</strong>是一种创建型设计模式，其在父类中提供一个创建对象的方法，允许子类决定实例化对象的类型。</p> <blockquote><p>《<a href="https://refactoringguru.cn/design-patterns/factory-method" target="_blank" rel="noopener noreferrer"><strong>深入设计模式</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>》工厂方法模式</p></blockquote> <h2 id="_2-使用场景"><a href="#_2-使用场景" class="header-anchor">#</a> 2. 使用场景</h2> <p><strong>降低代码复杂度及解偶时可以使用工厂模式。</strong></p> <p>新建对象都是使用new直接创建对象，这样在添加类似功能时，该对象需要大面积重写，这时候可以使用工厂模式，通过工厂模式进行对象创建，使用的也是new，只不过把对象创建交给工厂去做，新的对象就是工厂生产出来的产品，不同的工厂可以生产不同的产品。</p> <p>如：A饮品加工厂可以生产矿泉水、碳酸饮料、茶饮料等等；B饮品加工厂可以生产咖啡、果汁等。</p> <p><strong>以下是工厂模式的主要使用场景：</strong></p> <ul><li><p>当在编写代码的过程中， 如果无法预知对象确切类别及其依赖关系时，可使用工厂方法。</p> <ul><li>工厂方法将创建产品的代码与实际使用产品的代码分离， 从而能在不影响其他代码的情况下扩展产品创建部分代码。</li></ul></li> <li><p>如果希望用户能扩展软件库或框架的内部组件， 可使用工厂方法。</p> <ul><li>继承可能是扩展软件库或框架默认行为的最简单方法，将各框架中构造组件的代码集中到单个工厂方法中， 并在继承该组件之外允许任何人对该方法进行重写。</li></ul></li> <li><p>复用现有对象来节省系统资源， 而不是每次都重新创建对象， 可使用工厂方法。</p></li></ul> <h2 id="_3-实现方式"><a href="#_3-实现方式" class="header-anchor">#</a> 3. 实现方式</h2> <h3 id="_3-1-类图"><a href="#_3-1-类图" class="header-anchor">#</a> 3.1 类图</h3> <p><img src="https://tcs.teambition.net/storage/30238b5a27be7a88a146313221be3070b998?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTYxNzg2Mzk2OCwiaWF0IjoxNjE3MjU5MTY4LCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMwMjM4YjVhMjdiZTdhODhhMTQ2MzEzMjIxYmUzMDcwYjk5OCJ9._JBOFF4BxXQK9r3pxyfEFIfqx7oCF1y1TqbCmDmWu2Y&amp;download=factory_method.svg" alt=""></p> <h3 id="_3-3-实现方式"><a href="#_3-3-实现方式" class="header-anchor">#</a> 3.3 实现方式</h3> <ul><li><p>CreatorFactory 创建工厂抽象类，其 create 方法必须返回值必须为产品接口为保证子类一定覆盖夫类 create 方法，需将 create 方法设置为抽象方法。</p> <ul><li>注意， 并不一定每次调用工厂方法都会<strong>创建</strong>新的实例。 工厂方法也可以返回缓存、 对象池或其他来源的已有对象。</li></ul></li> <li><p>CreatorFactory 创建工厂主要职责并非创建产品，其中通常会包含一些核心业务，其 render 方法为该工厂核心业务。</p></li> <li><p>Product 产品接口，所有具体产品必须实现该接口，该接口内定义产品的公共操作，其 do 方法为 Product 产品的公共操作。</p></li></ul> <h2 id="_4-优点缺点"><a href="#_4-优点缺点" class="header-anchor">#</a> 4. 优点缺点</h2> <h3 id="_4-1-优点"><a href="#_4-1-优点" class="header-anchor">#</a> 4.1 优点</h3> <ol><li><p>可以避免创建者和具体产品之间的紧密耦合。</p></li> <li><p><em>单一职责原则</em>。 你可以将产品创建代码放在程序的单一位置， 从而使得代码更容易维护。</p></li> <li><p><em>开闭原则</em>。 无需更改现有客户端代码，你就可以在程序中引入新的产品类型。</p></li></ol> <h3 id="_4-2-缺点"><a href="#_4-2-缺点" class="header-anchor">#</a> 4.2 缺点</h3> <ol><li>应用工厂方法模式需要引入许多新的子类，代码可能会因此变得更复杂。最好的情况是将该模式引入创建者类的现有层次结构中。</li></ol> <h2 id="_5-工厂方法"><a href="#_5-工厂方法" class="header-anchor">#</a> 5. 工厂方法</h2> <h3 id="_5-1-ioc框架"><a href="#_5-1-ioc框架" class="header-anchor">#</a> 5.1 IOC框架</h3> <p><strong>如果项目中使用IOC框架（Spring）并且复用现有对象，可以参考该方式。</strong></p> <ol><li><p>将不同的Product实现按照约定格式指定beanName注入，比如：@Component(“XmlProduct”)。</p></li> <li><p>使用时通过 applicationContext.getBean(typeSuffix+Product) 即可。</p></li> <li><p>拓展可以通过写一个xxProduct，进行注入。</p></li></ol> <p><strong>工厂方法示例：</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreatorFactory</span><span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token class-name">Product</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token class-name">String</span> suffix<span class="token punctuation">)</span><span class="token punctuation">{</span>
	    <span class="token keyword">return</span> <span class="token class-name">InstanceLocator</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>suffix<span class="token operator">+</span><span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优点：可以减少工厂类创建，扩展更加容易。</p> <h3 id="_5-2-map形式"><a href="#_5-2-map形式" class="header-anchor">#</a> 5.2 Map形式</h3> <p><strong>如果工厂生产产品为复用现有对象，可以参考该形式。</strong></p> <ol><li><p>将不同的Product进行提前初始化并存放至Map内。</p></li> <li><p>创建初始化方法，传入对应产品key获取对应产品。</p></li> <li><p>扩展可以通过在工厂方法Map内添加新的Product。</p></li></ol> <p><strong>工厂方法示例：</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreatorFactory</span><span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Map</span> cachedFactories <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token punctuation">{</span> 
		cachedFactories<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		cachedFactories<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token class-name">Product</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>
	    <span class="token keyword">return</span> cachedFactories<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_6-其它设计模式关系"><a href="#_6-其它设计模式关系" class="header-anchor">#</a> 6 其它设计模式关系</h2> <ol><li><p><strong>抽象工厂模式</strong>通常基于一组工厂方法。</p></li> <li><p><strong>工厂方法</strong>是<strong>模板方法模式</strong>的一种特殊形式。 同时， <em>工厂方法</em>可以作为一个大型<em>模板方法</em>中的一个步骤。</p></li> <li><p>可以同时使用<strong>工厂方法</strong>和<strong>迭代器模式</strong>来让子类集合返回不同类型的迭代器， 并使得迭代器与集合相匹配。</p></li> <li><p><strong>工厂模式</strong>可以演化为使用<strong>抽象工厂模式</strong>、 <strong>原型模式</strong>或<strong>生成器模式</strong>。</p></li></ol> <blockquote><p>《<a href="https://refactoringguru.cn/design-patterns/factory-method" target="_blank" rel="noopener noreferrer"><strong>深入设计模式</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>》工厂方法模式</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.3776ebbf.js" defer></script><script src="/assets/js/5.eba49061.js" defer></script><script src="/assets/js/21.b3ec0304.js" defer></script><script src="/assets/js/6.a088a84b.js" defer></script>
  </body>
</html>
